/* Pretendard 폰트 */
@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========================================
   Base Styles - Flat & Minimal
   ======================================== */
@layer base {
  html {
    font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  body {
    @apply bg-flat-gray-50 text-flat-gray-900;
  }

  /* 모바일 최적화 */
  * {
    -webkit-tap-highlight-color: transparent;
  }
}

/* ========================================
   Flat Design Components
   ======================================== */
@layer components {
  /* 플랫 카드 스타일 - 그림자 없음, 테두리로 구분 */
  .card-flat {
    @apply bg-white rounded-flat-lg border border-flat-gray-200;
  }

  /* Inset Grouped 카드 */
  .card-inset {
    @apply mx-4 rounded-flat-lg bg-white border border-flat-gray-200 overflow-hidden;
  }

  /* 카드 아이템 (리스트 내 아이템) */
  .card-item {
    @apply px-4 py-3 flex items-center justify-between;
    @apply border-b border-flat-gray-100 last:border-b-0;
  }

  /* 기존 카드 스타일 (호환성) */
  .card {
    @apply bg-white rounded-flat-lg border border-flat-gray-200 p-4;
  }

  /* Apple 스타일 호환 (기존 코드 호환) */
  .card-apple {
    @apply bg-white rounded-flat-lg border border-flat-gray-200;
  }

  /* ----------------------------------------
     버튼 스타일 - 플랫
     ---------------------------------------- */
  .btn {
    @apply px-4 py-2 rounded-flat-md font-medium transition-colors duration-fast;
  }

  .btn-primary {
    @apply bg-flat-blue text-white;
    @apply active:bg-primary-600;
  }

  .btn-secondary {
    @apply bg-flat-gray-100 text-flat-blue;
    @apply active:bg-flat-gray-200;
  }

  .btn-text {
    @apply text-flat-blue font-medium;
    @apply active:opacity-70;
  }

  .btn-destructive {
    @apply text-flat-red font-medium;
    @apply active:opacity-70;
  }

  /* ----------------------------------------
     토글 스위치 - 플랫
     ---------------------------------------- */
  .toggle-flat {
    @apply relative w-[51px] h-[31px] cursor-pointer;
  }

  .toggle-flat input {
    @apply sr-only;
  }

  .toggle-flat .toggle-track {
    @apply absolute inset-0 rounded-full;
    @apply bg-flat-gray-300 transition-colors duration-150;
  }

  .toggle-flat input:checked + .toggle-track {
    @apply bg-flat-green;
  }

  .toggle-flat .toggle-thumb {
    @apply absolute top-[2px] left-[2px] w-[27px] h-[27px];
    @apply bg-white rounded-full;
    @apply transition-transform duration-150;
  }

  .toggle-flat input:checked ~ .toggle-thumb {
    @apply translate-x-[20px];
  }

  /* Apple 토글 호환 */
  .toggle-apple {
    @apply relative w-[51px] h-[31px] cursor-pointer;
  }

  .toggle-apple input {
    @apply sr-only;
  }

  .toggle-apple .toggle-track {
    @apply absolute inset-0 rounded-full;
    @apply bg-flat-gray-300 transition-colors duration-150;
  }

  .toggle-apple input:checked + .toggle-track {
    @apply bg-flat-green;
  }

  .toggle-apple .toggle-thumb {
    @apply absolute top-[2px] left-[2px] w-[27px] h-[27px];
    @apply bg-white rounded-full;
    @apply transition-transform duration-150;
  }

  .toggle-apple input:checked ~ .toggle-thumb {
    @apply translate-x-[20px];
  }

  /* ----------------------------------------
     세그먼트 컨트롤 - 플랫
     ---------------------------------------- */
  .segment-control {
    @apply flex bg-flat-gray-100 rounded-flat-md p-[2px];
  }

  .segment-item {
    @apply flex-1 py-[6px] text-subhead font-medium text-center;
    @apply rounded-flat-sm transition-colors duration-150;
    @apply text-flat-gray-500;
  }

  .segment-item.active {
    @apply bg-white text-flat-gray-900;
  }

  /* ----------------------------------------
     검색바 - 플랫
     ---------------------------------------- */
  .search-bar {
    @apply relative;
  }

  .search-input {
    @apply w-full h-[36px] pl-[32px] pr-3;
    @apply bg-flat-gray-100 rounded-flat-md;
    @apply text-body placeholder:text-flat-gray-400;
    @apply border-0 focus:outline-none focus:ring-1 focus:ring-flat-blue;
  }

  .search-icon {
    @apply absolute left-[8px] top-1/2 -translate-y-1/2;
    @apply w-[17px] h-[17px] text-flat-gray-400;
  }

  /* ----------------------------------------
     네비게이션 바 - 플랫
     ---------------------------------------- */
  .nav-bar {
    @apply sticky top-0 z-10;
    @apply bg-white;
    @apply border-b border-flat-gray-200;
  }

  .nav-bar-content {
    @apply flex items-center h-[44px] px-2;
  }

  .nav-back-btn {
    @apply w-11 h-11 flex items-center justify-center;
    @apply text-flat-blue -ml-2;
    @apply active:opacity-70;
  }

  .nav-title {
    @apply flex-1 text-headline text-center truncate;
  }

  /* Large Title 네비게이션 */
  .nav-large-title {
    @apply bg-white pt-safe-top pb-2 px-4;
  }

  .nav-large-title h1 {
    @apply text-title-large;
  }

  /* ----------------------------------------
     탭바 - 플랫
     ---------------------------------------- */
  .tab-bar {
    @apply fixed bottom-0 left-0 right-0 z-50;
    @apply bg-white;
    @apply border-t border-flat-gray-200;
  }

  .tab-bar-content {
    @apply flex justify-around items-center h-[49px] max-w-lg mx-auto;
    @apply pb-safe-bottom;
  }

  .tab-item {
    @apply flex flex-col items-center justify-center flex-1 h-full;
    @apply text-flat-gray-400 transition-colors duration-150;
  }

  .tab-item.active {
    @apply text-flat-blue;
  }

  .tab-icon {
    @apply w-[25px] h-[25px];
  }

  .tab-label {
    @apply text-caption-2 mt-[2px];
  }

  /* ----------------------------------------
     리스트 스타일 - 플랫
     ---------------------------------------- */
  .list-section-header {
    @apply text-footnote uppercase text-flat-gray-500;
    @apply px-4 py-2;
  }

  .list-item {
    @apply flex items-center px-4 py-3;
    @apply bg-white;
    @apply border-b border-flat-gray-100 last:border-b-0;
  }

  .list-item-content {
    @apply flex-1;
  }

  .list-item-title {
    @apply text-body;
  }

  .list-item-subtitle {
    @apply text-footnote text-flat-gray-500;
  }

  .list-item-accessory {
    @apply text-flat-gray-400 ml-2;
  }

  /* ----------------------------------------
     스켈레톤 로더 - 플랫
     ---------------------------------------- */
  .skeleton {
    @apply bg-flat-gray-200 rounded-flat-sm animate-skeleton;
  }

  .skeleton-text {
    @apply skeleton h-4 w-full;
  }

  .skeleton-title {
    @apply skeleton h-6 w-3/4;
  }

  .skeleton-avatar {
    @apply skeleton rounded-full;
  }

  .skeleton-image {
    @apply skeleton aspect-video w-full;
  }

  /* ----------------------------------------
     토스트 알림 - 플랫
     ---------------------------------------- */
  .toast {
    @apply fixed bottom-24 left-4 right-4 mx-auto max-w-sm z-50;
    @apply bg-flat-gray-900 text-white px-4 py-3 rounded-flat-lg;
    @apply flex items-center gap-3 animate-fade-in;
  }

  .toast-success {
    @apply bg-flat-green;
  }

  .toast-error {
    @apply bg-flat-red;
  }

  .toast-warning {
    @apply bg-flat-orange;
  }

  .toast-info {
    @apply bg-flat-blue;
  }

  /* ----------------------------------------
     타임라인 - 플랫
     ---------------------------------------- */
  .timeline-item {
    @apply relative pl-8 pb-6 border-l-2 border-flat-gray-200 last:border-l-transparent last:pb-0;
  }

  .timeline-item::before {
    @apply absolute left-0 top-0 w-3 h-3 -translate-x-1/2 rounded-full;
    @apply bg-flat-gray-300;
    content: '';
  }

  .timeline-item.active::before {
    @apply bg-flat-blue;
  }

  .timeline-item.completed::before {
    @apply bg-flat-green;
  }

  /* ----------------------------------------
     Pull to Refresh - 플랫
     ---------------------------------------- */
  .pull-indicator {
    @apply absolute top-0 left-1/2 -translate-x-1/2 -translate-y-full;
    @apply flex items-center justify-center w-10 h-10;
    @apply text-flat-gray-400 transition-transform;
  }

  .pull-indicator.pulling {
    @apply text-flat-blue;
  }

  .pull-indicator.refreshing {
    @apply animate-spin text-flat-blue;
  }

  /* ----------------------------------------
     로딩 스피너 - 플랫
     ---------------------------------------- */
  .spinner {
    @apply w-6 h-6 border-2 border-flat-gray-200 border-t-flat-blue rounded-full animate-spin;
  }

  .spinner-sm {
    @apply w-4 h-4;
  }

  .spinner-lg {
    @apply w-8 h-8;
  }

  /* ----------------------------------------
     빈 상태 - 플랫
     ---------------------------------------- */
  .empty-state {
    @apply flex flex-col items-center justify-center py-12 text-center;
  }

  .empty-state-icon {
    @apply w-16 h-16 text-flat-gray-300 mb-4;
  }

  .empty-state-title {
    @apply text-headline text-flat-gray-600 mb-2;
  }

  .empty-state-description {
    @apply text-subhead text-flat-gray-500;
  }

  /* ----------------------------------------
     칩/태그 - 플랫
     ---------------------------------------- */
  .chip {
    @apply inline-flex items-center px-3 py-1.5;
    @apply rounded-full text-subhead font-medium;
    @apply bg-flat-gray-100 text-flat-gray-600;
    @apply transition-colors duration-150;
  }

  .chip.active {
    @apply bg-flat-gray-900 text-white;
  }

  /* ----------------------------------------
     배지 - 플랫
     ---------------------------------------- */
  .badge {
    @apply inline-flex items-center px-2 py-0.5;
    @apply rounded-full text-caption-1 font-medium;
  }

  .badge-primary {
    @apply bg-primary-50 text-flat-blue;
  }

  .badge-success {
    @apply bg-green-50 text-flat-green;
  }

  .badge-warning {
    @apply bg-orange-50 text-flat-orange;
  }

  .badge-error {
    @apply bg-red-50 text-flat-red;
  }

  /* ----------------------------------------
     호환성 유틸리티 (기존 apple- 클래스 지원)
     ---------------------------------------- */
  .rounded-apple-sm { @apply rounded-flat-sm; }
  .rounded-apple-md { @apply rounded-flat-md; }
  .rounded-apple-lg { @apply rounded-flat-lg; }
  .rounded-apple-xl { @apply rounded-flat-xl; }

  .bg-apple-blue { @apply bg-flat-blue; }
  .bg-apple-green { @apply bg-flat-green; }
  .bg-apple-red { @apply bg-flat-red; }
  .bg-apple-orange { @apply bg-flat-orange; }
  .bg-apple-yellow { @apply bg-flat-yellow; }

  .text-apple-blue { @apply text-flat-blue; }
  .text-apple-green { @apply text-flat-green; }
  .text-apple-red { @apply text-flat-red; }
  .text-apple-orange { @apply text-flat-orange; }

  .bg-apple-gray-50 { @apply bg-flat-gray-50; }
  .bg-apple-gray-100 { @apply bg-flat-gray-100; }
  .bg-apple-gray-200 { @apply bg-flat-gray-200; }
  .bg-apple-gray-300 { @apply bg-flat-gray-300; }
  .bg-apple-gray-400 { @apply bg-flat-gray-400; }
  .bg-apple-gray-500 { @apply bg-flat-gray-500; }
  .bg-apple-gray-600 { @apply bg-flat-gray-600; }
  .bg-apple-gray-700 { @apply bg-flat-gray-700; }
  .bg-apple-gray-800 { @apply bg-flat-gray-800; }
  .bg-apple-gray-900 { @apply bg-flat-gray-900; }

  .text-apple-gray-400 { @apply text-flat-gray-400; }
  .text-apple-gray-500 { @apply text-flat-gray-500; }
  .text-apple-gray-600 { @apply text-flat-gray-600; }

  .border-apple-gray-100 { @apply border-flat-gray-100; }
  .border-apple-gray-200 { @apply border-flat-gray-200; }
  .border-apple-gray-300 { @apply border-flat-gray-300; }

  /* 그림자 제거 */
  .shadow-apple { @apply shadow-none; }
  .shadow-apple-lg { @apply shadow-none; }
  .shadow-apple-dark { @apply shadow-none; }

  /* backdrop-blur 제거 */
  .backdrop-blur-apple { backdrop-filter: none; }
}

/* ========================================
   Utilities
   ======================================== */
@layer utilities {
  /* Safe area */
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-right {
    padding-right: env(safe-area-inset-right);
  }

  /* iOS Safe Area 강화 */
  @supports (padding: max(0px)) {
    .safe-top-enhanced {
      padding-top: max(env(safe-area-inset-top), 20px);
    }

    .safe-bottom-enhanced {
      padding-bottom: max(env(safe-area-inset-bottom), 34px);
    }
  }

  /* 스크롤바 숨김 */
  .no-scrollbar::-webkit-scrollbar {
    display: none;
  }

  .no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  /* 터치 피드백 - 플랫 */
  .touch-feedback {
    @apply transition-colors duration-100;
  }

  .touch-feedback:active {
    @apply bg-flat-gray-100;
  }

  .touch-scale {
    @apply transition-transform duration-100;
  }

  .touch-scale:active {
    transform: scale(0.98);
  }

  /* 터치 최소 크기 */
  .min-touch {
    min-width: 44px;
    min-height: 44px;
  }

  /* 텍스트 줄임 */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
}

/* ========================================
   Dark Mode - Flat
   ======================================== */
@layer base {
  .dark body {
    @apply bg-flat-gray-900 text-flat-gray-100;
  }
}

@layer components {
  /* 다크 모드 카드 */
  .dark .card-flat,
  .dark .card-apple,
  .dark .card-inset,
  .dark .card {
    @apply bg-flat-gray-800 border-flat-gray-700;
  }

  .dark .card-item {
    @apply border-flat-gray-700;
  }

  /* 다크 모드 버튼 */
  .dark .btn-secondary {
    @apply bg-flat-gray-800 text-primary-400;
  }

  /* 다크 모드 세그먼트 */
  .dark .segment-control {
    @apply bg-flat-gray-800;
  }

  .dark .segment-item.active {
    @apply bg-flat-gray-700 text-white;
  }

  /* 다크 모드 검색바 */
  .dark .search-input {
    @apply bg-flat-gray-800 text-white;
  }

  /* 다크 모드 네비게이션 */
  .dark .nav-bar {
    @apply bg-flat-gray-900 border-flat-gray-700;
  }

  .dark .nav-large-title {
    @apply bg-flat-gray-900;
  }

  /* 다크 모드 탭바 */
  .dark .tab-bar {
    @apply bg-flat-gray-900 border-flat-gray-700;
  }

  .dark .tab-item {
    @apply text-flat-gray-500;
  }

  .dark .tab-item.active {
    @apply text-primary-400;
  }

  /* 다크 모드 리스트 */
  .dark .list-item {
    @apply bg-flat-gray-800 border-flat-gray-700;
  }

  /* 다크 모드 토글 */
  .dark .toggle-flat .toggle-track,
  .dark .toggle-apple .toggle-track {
    @apply bg-flat-gray-600;
  }

  /* 다크 모드 타임라인 */
  .dark .timeline-item {
    @apply border-flat-gray-700;
  }

  .dark .timeline-item::before {
    @apply bg-flat-gray-600;
  }

  /* 다크 모드 스켈레톤 */
  .dark .skeleton {
    @apply bg-flat-gray-700;
  }

  /* 다크 모드 토스트 */
  .dark .toast {
    @apply bg-flat-gray-700;
  }

  /* 다크 모드 칩 */
  .dark .chip {
    @apply bg-flat-gray-800 text-flat-gray-400;
  }

  .dark .chip.active {
    @apply bg-white text-flat-gray-900;
  }

  /* 다크 모드 터치 피드백 */
  .dark .touch-feedback:active {
    @apply bg-flat-gray-800;
  }
}
